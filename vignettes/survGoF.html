<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Michael Holton Price" />

<meta name="date" content="2018-08-15" />

<title>A general goodness-of-fit test for survival analysis</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">A general goodness-of-fit test for survival analysis</h1>
<h4 class="author"><em>Michael Holton Price</em></h4>
<h4 class="date"><em>2018-08-15</em></h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This vignette generates the figures for the article ``A general goodness-of-fit test for survival analysis’’ by Michael Holton Price and James Holland Jones. Although the article is currently in review, a preliminary version is available on biorxiv at <a href="https://www.biorxiv.org/content/early/2017/01/31/104406" class="uri">https://www.biorxiv.org/content/early/2017/01/31/104406</a>. This vignette will be updated with a link to the final article when it is in press. The vignette relies on open source code in the R package yada, <a href="https://github.com/eehh-stanford/yada" class="uri">https://github.com/eehh-stanford/yada</a>, which can be installed using devtools.</p>
</div>
<div id="probability-density-functions-of-the-msr-and-nmr" class="section level2">
<h2>Probability density functions of the MSR and NMR</h2>
<p>Section 2 defines the Martingale Survival Residual (MSR) and Negative Martingale Residual (NMR) and Appendix A derives their probability density functions (PDFs) assuming constant event occurrence and censoring (Equations 43 and 44). These can be caculated with the yada functions <code>calcMSRDensityConstHaz</code> and <code>calcNMRDensityConstHaz</code>. The overall PDF can be calculated, as can the components due to event occurrence and censoring. Plot the MSR PDF for censoring ratios of 0% and 25%,</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(yada)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">Dplot_MSR &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dt">len=</span><span class="dv">1001</span>) <span class="co"># The locations at which to plot the PDFs</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">plot</span>(Dplot_MSR,<span class="kw">calcMSRDensityConstHaz</span>(Dplot_MSR,.<span class="dv">25</span>,<span class="dt">component=</span><span class="st">&quot;event&quot;</span>),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;MSR PDF&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'gray'</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">lines</span>(Dplot_MSR,<span class="kw">calcMSRDensityConstHaz</span>(Dplot_MSR,.<span class="dv">25</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'gray'</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">lines</span>(Dplot_MSR,<span class="kw">calcMSRDensityConstHaz</span>(Dplot_MSR,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'black'</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">legend</span>(<span class="st">'topright'</span>,<span class="kw">c</span>(<span class="st">'No Censoring'</span>,<span class="st">'25% Censoring'</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">'black'</span>,<span class="st">'gray'</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Make a similar plot for the NMR PDF (not on the same interval as the preceding plot since the NMR ranges from -1 to Infinity),</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">Dplot_NMR &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>,<span class="dt">len=</span><span class="dv">1001</span>) <span class="co"># The locations at which to plot the PDFs</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">plot</span>(Dplot_NMR,<span class="kw">calcNMRDensityConstHaz</span>(Dplot_NMR,.<span class="dv">25</span>,<span class="dt">component=</span><span class="st">&quot;event&quot;</span>),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;NMR PDF&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'gray'</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">lines</span>(Dplot_NMR,<span class="kw">calcNMRDensityConstHaz</span>(Dplot_NMR,.<span class="dv">25</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'gray'</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">lines</span>(Dplot_NMR,<span class="kw">calcNMRDensityConstHaz</span>(Dplot_NMR,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'black'</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">legend</span>(<span class="st">'topright'</span>,<span class="kw">c</span>(<span class="st">'No Censoring'</span>,<span class="st">'25% Censoring'</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">'black'</span>,<span class="st">'gray'</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6kNtmAABmADpmtrZmtv+QOgCQOjqQkGaQtpCQ2/+2ZgC2tma225C2/7a2//++vr7bkDrbkJDb/9vb////tmb/trb/25D//7b//9v///9lfZsiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAY0UlEQVR4nO2da2OjOJZASU0lPdvxTDI98e6W2S1vbP//37ggAQbMS7qSuYJzPnTcMQhZ99TVAyJnNwAB2doVgLRBIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoGIwAJlsBHWEihscZsiqbZBIH0k1TYIpI+k2gaB9JFU20QS6PppR1g/fgUpbl8k1TZxBMqzd/viXL8QFbczkmqbKAJdPxtt8p+/xcXtjaTaJopAl8NH/fI80okl1UhPJqm2IQPpI6m2iTUGqlIQYyAPkmqbSLOwy8HOwkbyT2KN9GSSahvWgfSRVNsgkD6SapvYAuVLZ2FJtVpckmqKJ2eg0acAHJ4L2Dz+LXH9tP9ej49jT3NvYHRI+khrKWYSLV2Yy5MlW0ciUPZa/nwUyE6Hjy9fgnoNokUgUtAdiUB/+6NU5EGg77cP+75DDloGAumj1xAODwReP1/zMgUZgc7Fu/UqXL2e+39lD5fbNy6Hfx6ycsHu+y0zP+szLv/4K/vx30UX1hxxO2bZy1+D6UuTQBhk6baDyyOlhUBm7FIKdM5KA17r398PygsRvt/eizeLF8X/mOxUHl2fcTkUp1+MQPaI27EYWp2z5wlULyNOPNDxUNwJgWpEGcgkm0IgezvpbIN+OdxvCNjX5x+/zIvCnvp2ZXOGecMKZI+wHeDwACpOBqpnAy7FIVCNZAz0ajwoBLJBr8Y+bYGsU8UbJlcV/7kcbLCaM+o3bvULq9j5mV1YJ2cuK44+rEYmUJlcGoGqyXg7HOcqdd09MTP8j1tzxoNA+fMFMv2pW3H0YTVCgW7H934GagbRRVgaDxpPSo7VWEhLBvIpjhRUIRXo+4//6I2B2tP4ZoWwI1DxszUG6glkz861C0QKqpAKVEy6e7OwaiHx+lk6YEQ43j0xkpX/uc/CegI9fRbmVxwCVYgFMvPwzjpQNTO2HVluJ8eNHuWBRo56HehBoHId6Md/Dk6MFAlEH1ahtBGGn07WJBApyKKuEcwYqL0U0EKbQOoabwX0tYGZ+g9Pq1UJRAoyJNUGCKSPpNpAk0D0YZakmkCXQKSgkqSaQJVApCCDoAXMba1ytmQfiHg1D/uUqz/Xz4/eUYEeb1UmECnoJltILB/gMd788VX95t3eYW3d3A76eKtCgXZvkH8DVDetyhsP1apfKVL+8/f1X1+9g0I93qpNIFKQvKnL+1p5lXEqgdoJKOzjrQikj14DnCYZOL+89Xn80wpgurD3dgIK/HirLoEYBJV0G2DanwGDyiGOvZ16fK8G0e0EFPjxVo0C7d0gWQY6Z40tjQ7/KkSon04P/HirMoFIQTdhU7c31KmfRywS0PG1/mOxwI+3qhRo5wZJPn7e3pCpmsubBPTe5KOwj7fqE4gUJPj49c5eVoBKmfPrrS1Q2MdbtQlECpKtA9X552ifri9fminYvQsL/HirQoF2n4L8P31uhzTGiuYJHrMkdB9E38I+3opA+kjg05+1C5RAG8ZD9YfvP96qTiBSkG6B+o+3ahVIdyPGJanPrlKgnaegpD67PoFIQUl9dJ0C7Xuvl6Q+uk6B9t2HJfXRFQq0+z4sqU+uVKBd92FJfXLFAiXVjiFJ6oMrFWjXKSipD65RoL33YdPbsmpj8acK3EhTb572PoxOCJUC7T0FpYRqgTBIP2oFIgWlgU6BSEHJoFggUlAKIBCI0CsQfVgSKBWoSUEYpBzFAtGJpYBWgUhBiaBbIFKQehAIRGgWiD4sAdQKRApKA9UCkYL0o1cgUlASpCAQBilGt0CkIPUoFog+LAUiCXTMstdqw0//4ujDEiCOQOVGoMdyv+KRL9p0EYgUpJooApk9Pu1OsPnIN3osFIgUpJ0oApm9GKsNhQe/K3phcaQg/WjOQKSgBIg8BrIbVnsXRwpSj+ZZGCkoATSvA91IQfpJRiAM0klsgXLJLKwRiBSklidnINddQU70YcpR3oXRh2knAYEwSDORBDJT+CzLRkZADsUxCtJNpIXE+osX29/g6VdcSyAMUki8WxkW0a2MkhMpSDXxbqZaRDdTDQikGvUZiD5MN7HGQFUKko+BOn0YBqkj0izMfK1rVn+zq6y4WiA6MY1oXwe6dQXCIG2kIRApSC0JCEQfppnUBMIgZSQiEAZpJQWB7imITkwdqQjEKEgpSQjEKEgvyQhECtJJGgKRgtSSmkAYpIzkBKIT00U6AjGTV0kiAtGHaSUhgTBII6kIxChIKSkJRApSSDICkYJ0kqpAGKSEpAQiBekjHYFIQSpJSyBSkDoSEogUpJFEBSIFaSExgUhB2khJoH4KwiAFJCsQnZgOUhOIUZAykhKIPkwfyQmEQbpISyBGQepIXCAMWpv0BCIFqSIxgUhB2khQIFKQJlITiBSkjBQFwiBFJCdQNwXRia3NBgTCoDVJUiBSkB7SE4gUpIo0BcIgNSQoUC8F0YmtSqICMQrSQooCMQpSxAYEwqA1SVUgRkFKSFIgUpAekhWIFKSDNAUiBakhXYEwSAWJCtRPQXRia5GwQKQgDaQqEClICZEEOv74dft+y7KXryDFDUAK0kEcgYw/f3yV3x//EaC4QQZSEAY9nygCXQ7vhUSv5cv8529xccP0BaITW4VIAn3crp/v5ctzkYukxQ3T78NIQasQqQsrsk8eOQMNpiAMejZxBLocfvwyKeg8NooOIxCd2OrEmsafM8NroOIGIQUpINl1oBspSAUpC0QKUkBsgfJos7DbSArCoKfy5AyUNQQp7kEgOrFn4yjQ6MpytOtOEisF9bWEUXwEqtYIn3PdaQZTUPAbtTBOJIGun7ajGhkBhRQoQic2UCqMEEegPKuOOGcjh4YaqURJQScMWkwUgVoHRLyVYYiSghBoOVEEag21491MrYiRgk4YtJjUM9BICpL/1RACLcNZoPtKzugAuRwDVSko+hhocMokNQiBlhNpIbEWbST/BBZoyCBpkRi0jKTvhVnCp6CyRAxahrtANrmMppbQ151nJAUJrmAKRKBFOAt0tMObfGxwE/q6CxgKdRCBMGgeV4GaRwy/30R3xQILFDYF2fIQaAmOAl0/m2cMj6NPGwa97hJCp6BGIAyaxXkaf1/hmZjGB7zuEkYE8r5GVR4CLcD/cY6xNebA113CYK4QGHQXCIPm2IRAowb5F9f5CeNsQ6DAnVhLIAyaYTsCBTSoKQyBZolzLyzgdRcyGGpfg9oCYdA0G7iVYRgOtVQgUtAsWxEoaArqCIRBkzgLlBcxCfCXGTEECmZQqygEmsFVoPzlS3oXw+26iwloUFcgDJrC+VZGuRI99phhjOsuZzjUQoFIQTN4TeNlM3i36y5nVCDna/UEwqAJtiVQIIM6BWHQJBsSKJxB3XIQaIotCTQWagSKyNYECpKCHgTCoFG2civDMp6CnK7XKwaDJtjMSrRhLNQygejEJtiWQIFS0IBAGDTC9gQKYNBDIQg0ysYEGg21k0FDAmHQMBsUaNQgl0KWFrt7BAL9j75Z2C1MJzZQBAKN4PM4h5m/Xz8VTuNLAnRiwwJh0BA+f5l6/Pm7/CoD0d82RxVIatBQCQg0jM9fpl4OH/n4dxEGvq47o6GWCoRBA/j8Zer188/xb1EJfV135ClosAAEGsTrXthRuDWHy3U9mEpBi647JhAGPeInkMonEhvGQ73QoOHzEWgIP4GkHVhcgcQGjQqEQQ9sUqCJZCEQCIOG2KxAkhQ0djYCPbKt54EaZAZNCIRBPbZ2L6xmshObu/joyQj0wIYF8jdoSiAM6uK8Ep1GFzaZLPwFwqAHXDPQ5SC8h+F6XV8kKWjCEgzq4d6FFUlI/oWF8QWSGDQlCQJ18RoDHWXdl9N1/ZnuxKYqMCMQBrXwHETn0j1eniOQp0GTjiBQB+9Z2Peb7kH0bTrUkwbNCYRBd/wEKidjsl7sSQL5GTStCAa18RHoHGCTsmcINGvQxHkzxQoqtTHcBTpm4qfJXK4rwjMFzQuEQTWuAuXyCZjbdUV4dmJzgmDQnc2uRFv8DJr1A4EatnovrGYy1GMGLREIgyw7EMjdoHk9EKhmo88D3Zk1aPgcUal7wjsDLfnLjIkNpZ8m0Hwn9liVBXZgUIWnQEUmmlgJWpCnniqQq0FL5EAgi59A55n+62zTk4oM5DEMWigQBt08Bcpnvzb+ciiP0CHQjA8DBi1yA4MMHgIteyDoOP2lGk8WyM2gZWpgUIm7QNPDnzt59q5EIGeDFpqBQDcPgeaGP3e+3/6mRKC5UPcNWi4QBrnfC1t+J7Xo6/QI5GLQUjEwaAcLiRY3gxZ7gUHRb2Xkq68DWZwMWq4FAj35Xtg9fwUpzoG5ULfr5CTQzg3a+s3UhtlQtwxysGL3Bu1GIBeDXKRAoNAHGuoHz0YH2s8XyMEgR4F2bVAcgfJ6rfo8tmi9gkDzXtQGOTmxc4OiCGS/29kw9gXPKwm0zCA3JfZtUBSB7D5mhrEvN1xDoMUGORqBQEEPvKnNQIsNchdovwbFGgNVKUjVGOi2JFmUBrkKsWeDIs3C6lseo88NrSfQMoOCF7tV9rMOZFlqkHuxvjVKnL0JtCTUHnda9puC9igQBgVkdwItCfUJgxazP4EWhPrkaZB3lRJmhwIt+tN3d4N2moJ2KtDs9i0e46B9GrRHgWZDbd7GoEXsUqC5UNt3MWgJ+xRoJtTVm14GSWqVIjsVaNqg+j3nh7d3mIL2KtBkrJu3MGiW3Qo0840q1SsMmmPXAo2FuvUOBs2wX4EmQt1+w8cgUbUSY8cCjRvU/b2jQad95aA9CzRqUO/XGDTBrgUaM6j/W8duDIFEB65SnC/LBMKgcRBoINaPv8OgMXYu0LBBQ+HHoGH2LtBgqAejj0GD7F6goVAPB9+tG9uLQQg0EOqR2GPQAAg0EOqx0DsZtJPlIAS6PRo0HnkM6oNAJb1QTwTeNQmJqpUCCGToGjQVeBeD9pCDEMjSCfVk2DGoAwJVtEM9E3VHg0TVUg8C1bRiPRd1hyS0eYMQqOEe69mgY1ADAt1pYj0fcwyqQaAWdayXhHy5Qts2CIHaVLFeFHEMMiBQBxvrZQFf/qUxW57NI1AXE+ql4cYgBHrgdHKINgYh0AMuAi1XaLMGIdADbrHeu0EI9IhbqBePpbdpEAIN4BjqXRuEQEP4GLTgE23RIAQaxHXEsl+DEGgYL4PmP9T2DEKgEZxDvdygTSmEQKO4xnlZEtqaQQgUkD0ahEAhWZSEtmUQAoVliUKbMgiB5vAZSy9JQv41UgUCzeAe630lIQSawyPUezIIgWbxiPWCJLQVgyIJlBftZ746Pv/xK0Bx6+IT690oFEeg/OXrdjm83rYhEAZNEEWg6+e7+e/P39sQyG/alM06tAWDogh0OZju63b8+XsjArlO5i3zWSh9gyJmoILj61YE8mMHSSjSGKjS5nLIdi3QbT4LpW5QtFmY7cSun3sXaDYLJW4Q60Bu+MR600kIgZzwjPWGk1BsgbY2iPaN9bRCCRv05AyUNQQpbgXc/nD1zszHTlYhujBnZElo7IOnahACueMd60mFfFPbykQS6Ppp22pkBJS2QIIF5HmFBLVahUgLiVm1FH2uX4iK04d/oKcUSjEJxb2VUaj087e4uI2xLYWi3kwtOG9sGh+ECYWSM4gMJMI31hOLGYkpFGsMVKWgrY6BKgSxnlNIVK8nEmkWdjnY5hnJP1sRSJQuxhVKKQmxDiRDFusNKIRAUoIo9NAcyRiEQHJksU5cIQQKgDDUSSuEQGEQxnlYoVMCCiGQEobTkH6FEEgNUwqtU6MlIFBYggyGuo2jWyEECoo42IMOaVYIgcIiH7QMKaR4KIRAoQkQ7AGH1CqEQOEJEetHh5QqhEAxCBHp7MGhk0aHECgOQaKcgkIIpJu+Q+oUQqDIyIM94pC0YoFAoLgECXZ/OKRJIQSKTKBg9xzS05MhUHRCxbrrkBaFEOgJBAt11pZIh0II9BTCRVqbQwj0LMJFue3Q6goh0NMJ3Jmd1nUIgZ5NsGBnDxKFKNW5FsEPXKW4lAgY7exBohClulUh+IGrFJcUQTudtR1CoDUIPGx5kChQuYuuHfzAVYpLj9Bx7ksUsuzJ6wY/cJXi4NZ1KHuWQwikgIDB7kkUqtiJCwY/cJXikib0Qk5HotgNjUAKaKZlUVar40qEQCqIspycPcMiBFJDnFWc2BYhkCpOA6/kxJQIgXQSOh2dTpEsQiCdxBgUnR4sChAFBFJKhJlZVWpfIlkoEEgxcZ7SOA1a5BsQBNJN25+ALlVqBtAIgZIhdJd2GrXIJTgIlA73YVG4Xu00odGiGCFQSsQbWXtrhECp0fUnlEqn04xGYwFDoKQJnJFO7h4hUNpEGBedpjXqHY1AiRNjZH17sOjuUf9ABNoEvXFRIJ8eLBooFYE2x2S8xQX2S0Sg7RHcoHah/d8j0FbpxTvKSOmGQHshSlYqQaCdMGyQXCgE2hnD/Zq/RpEEun7aVYMfv4IUB5GYykvLjIojUJ692xfn+oWoOIjKiD/LLIoi0PWz0Sb/+VtcHDwZl/FSFIEuh4/65XmkE0Mg9Yzkpd5RZCBYyDMXEvOsSkGMgbZOpFnY5WBnYSP5B4E2A+tAIAKBQERsgXJmYdvmyRlI8BdsoBK6MBCBQCCCm6kggpupIIJbGSCCm6kgggwEIriZCiK4mQoiWAcCEQgEIhAIRCAQiEAgELGaQLARVhIoVvmBHlsKUgqVCX/96OWv3UwRitlIZRBorWI2UhkEWquYjVQGgdYqZiOVQaC1itlIZRBorWI2UhkEWquYjVQGgdYqZiOV4d4DiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoGIiAJ9/73ZQ+icZS9fXoW0z7RbO7yKyli5KiVB2qVdjHdlzI6FzT4rfpWJJ9Dl0GxCdS4qdvZqqc6Z3394NXanjHWrUhKkXTrF+Fbm+llcO6/N86xMNIHO96047cZUR69/Iu0zx7ZFcyhj3aqYM0O0S6cY78p8v5XbPVV7xvtWJpZA5+y9+VydijrRPTP3aupOGetW5RaqXTrF+FfGFmWzjm9lIo6B7g1lUqzPv5Pumcc/2122VxnrVsUSoF06xYgqU5wta5lnCGQd9+nsO2deDuXGaEfXluqUsW5VqpLk7dIpRlSZZrdC38okJFCvVK8y1q1K77RAAskq0x5DaxUoVL9hf/X2MXr4fBnrVsUSvAsTVOa+W6qeLiyvO2TZYNEUM3Cm85w1yiDaryqWEIPo26NAPpXJ70MnzYPoQHNn+xGd/43EmMZ7VsUSoF06xfhXptm2WVCZZwgUavXOfDr3wWKMhUTPqtiCgiwktmdhnpX5fmufo20hsfqE18/y0+XeS/bVmbaYY9GtefT0nTLWrUpJkHbpFOPfLiUvX5LKcDMVRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgELFzgcxGtyMbxF0O9d+bD+05YN+9flZbHNg/L++fuAN2L5CJ+3l6b4JxgZoz2yUg0H6oBGrnjwEmBLoc7JnHcp/C7lv7AIHMTxP/em+17zezXYr1oNz05K+XL/M/5j/VXiq1JXaT08vBbM/UvHU/PJfsoJoACNT8yIs8U+65ZHb8Krokq0vhxzlrCXSsjqwFqvYHK3NU663m8LrQzYJA5Y/cJJwyzOcfv+qtv8r4Wz2Od4Eu//iy0tQCVVs8FRms/VZzeF3oOh/vCexeIDsL+6gHOoUA9bdQlBLY0J/bXZj5moG7QGZfymaL1Pqt+vCm0BU+23PYvUCvZXzLJHLOapeMVVaR/EGgYkzz479aGah1WOutRqCm0K2CQLdqt+TuVKvqtR4ykEkm7S6s7L7+15TSfqubgbYMApU/jq1RsaWSoNo9uRTo3dhhjDq3u7BCr3/fN+k+113Ye9Udbjf3WBCo/GG+biI3M6mXL5M16qRT/vJsNjL9+bvo2j5shiky1l2N6+efZhGo/VZ9eFPoeh8xMghkfpot28slG5tFzIa3nXUg87WA/7RjoJevelp2u59cHVq/VR/eFLpVdi4QSEEgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRPw/cQuBdqeKYAEAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
</div>
<div id="illustration-of-the-kolmogorov-smirnov-statistic" class="section level2">
<h2>Illustration of the Kolmogorov-Smirnov statistic</h2>
<p>Our goodness-of-fit test for survival models relies on the Kolmogorov-Smirnov statistic, which in turn relies on the maximum distance between the empirical cumulative density function (empirical CDF or ECDF) and the CDF of the reference distribution. We illustrate this graphically. First, create some simulated data (with only four data points to aid visualization). The yada function <code>simLinHaz</code> creates simulated data with a linear event hazard and constant censoring hazard. To make this precise – and using the notation in the article linked to above – the event and censoring hazards are, respectively,</p>
<p><span class="math display">\[\lambda(t) = b_1 + a_1 \, t\]</span></p>
<p>and</p>
<p><span class="math display">\[\lambda^C(t) = b_2 \mbox{,}\]</span></p>
<p>where <span class="math inline">\(t\)</span> is time and <span class="math inline">\(a_1\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> are variables that parameterize the hazards. <code>simLinHaz</code> creates simulated data per these hazards, returning a data frame with two columns, time and status, where time is the event (or censoring) time and status is 1 for event occurrence and 0 for censoring:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Set the random number seed</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">60498</span>) <span class="co"># Chosen to effectively illustrate the Kolmogorov-Smirnov statistic</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">rho &lt;-<span class="st"> </span><span class="fl">.2</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">b1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">20</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">b2 &lt;-<span class="st"> </span>b1<span class="op">*</span>rho<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>rho) <span class="co"># Censoring rate [rho is only apporoximately the censoring ratio given a linear event hazard]</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">a1 &lt;-<span class="st"> </span>b1<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">survObjLin &lt;-<span class="st"> </span><span class="kw">simLinHaz</span>(n,b1,a1,b2)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">print</span>(survObjLin)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; [1]  2.816630   1.292374  14.725659   4.573699</span></a></code></pre></div>
<p>Given the chosen seed, there are no censored events. We now fit the simulated data with an incorrect model by calling the yada function <code>fitConstHaz</code>, which does a maximum likelihood fit assuming a constant event and censoring hazard. From this fit, calculate the predicted cumulative hazard at the occurrence time accounting for both events and censoring:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fitConst &lt;-<span class="st"> </span><span class="kw">fitConstHaz</span>(survObjLin) <span class="co"># The wrong model</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">cumHazEvent &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b1 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">cumHazCens  &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b2 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">cumHazTot &lt;-<span class="st"> </span>cumHazEvent <span class="op">+</span><span class="st"> </span>cumHazCens</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">print</span>(cumHazTot)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [1] 0.4813031 0.2208398 2.5163075 0.7815496</span></a></code></pre></div>
<p>By modeling both event and censoring hazards, the censoring status is immaterial for the calculation of the data residuals. The data is fit with an incorrect model to provide a large difference between the ECDF and reference curve (see below). Call the yada function <code>calcMSR</code> to calculate the MSRs and run a Kolomgorov-Smirnov test on the residuals assuming a uniform reference PDF on the interval -.5 to .5 (linear CDF).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Martingale Survival Residual treating censoring as a competing risk</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">msrTot &lt;-<span class="st"> </span><span class="kw">calcMSR</span>(cumHazTot)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">ksLin &lt;-<span class="st"> </span><span class="kw">ks.test</span>(msrTot, punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a></code></pre></div>
<p>Calculate the empirical CDF by calling the yada function <code>caclStoppingCDF</code>, which can be considered a generalization of the base R function ecdf (for details, see the documentation for <code>calcStoppingCDF</code>). Also determine the index where the difference between the empirical CDF and reference distribution is maximum.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">cdf &lt;-<span class="st"> </span><span class="kw">calcStoppingCDF</span>(msrTot,<span class="kw">rep</span>(F,<span class="kw">length</span>(msrTot)),<span class="dt">where=</span><span class="st">&quot;both&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">indMax &lt;-<span class="st"> </span><span class="kw">which.max</span>(<span class="kw">c</span>(<span class="kw">abs</span>(cdf<span class="op">$</span>y<span class="fl">+.5</span><span class="op">-</span>cdf<span class="op">$</span>before),<span class="kw">abs</span>(cdf<span class="op">$</span>y<span class="fl">+.5</span><span class="op">-</span>cdf<span class="op">$</span>after)))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">isBefore &lt;-<span class="st"> </span>indMax <span class="op">&lt;=</span><span class="st"> </span><span class="kw">length</span>(cdf<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">ind0 &lt;-<span class="st"> </span>isBefore<span class="op">*</span>(indMax) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>isBefore)<span class="op">*</span>(indMax<span class="dv">-4</span>)</a></code></pre></div>
<p>Plot the emirical CDF and show the maximum distance between the empirical CDF and reference distribution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(shape)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x=</span><span class="ot">NULL</span>,<span class="dt">y=</span><span class="ot">NULL</span>,<span class="dt">frame=</span>T,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Empirical CDF&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span>cdf<span class="op">$</span>y[ind0],<span class="kw">c</span>(<span class="dv">0</span>,cdf<span class="op">$</span>before[ind0]),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="cf">if</span>(isBefore) {</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="kw">stop</span>(<span class="st">&quot;This should not happen for the seed used&quot;</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">    <span class="kw">lines</span>(<span class="kw">c</span>((cdf<span class="op">$</span>y[ind0]<span class="op">-</span>.<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>,cdf<span class="op">$</span>y[ind0]),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span>cdf<span class="op">$</span>y[ind0]<span class="op">+</span>.<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">    <span class="kw">lines</span>(<span class="kw">c</span>((cdf<span class="op">$</span>y[ind0]<span class="op">-</span>.<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>,cdf<span class="op">$</span>y[ind0]),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span>cdf<span class="op">$</span>after[ind0],<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">    <span class="kw">Arrows</span>((cdf<span class="op">$</span>y[ind0]<span class="op">-</span>.<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>,cdf<span class="op">$</span>y[ind0]<span class="op">+</span>.<span class="dv">5</span>,(cdf<span class="op">$</span>y[ind0]<span class="op">-</span>.<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>,cdf<span class="op">$</span>after[ind0],<span class="dt">code=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">arr.type=</span><span class="st">&quot;triangle&quot;</span>,<span class="dt">arr.adj=</span><span class="op">-</span>.<span class="dv">5</span>,<span class="dt">arr.length=</span>.<span class="dv">25</span>,<span class="dt">arr.width=</span>.<span class="dv">25</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">    </a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    <span class="kw">text</span>(<span class="dt">x=</span>(cdf<span class="op">$</span>y[ind0]<span class="op">-</span>.<span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span><span class="fl">-.1</span>,<span class="dt">y=</span>(cdf<span class="op">$</span>y[ind0]<span class="op">+</span>.<span class="dv">5</span><span class="op">+</span>cdf<span class="op">$</span>after[ind0])<span class="op">/</span><span class="dv">2</span>,<span class="dt">labels=</span><span class="kw">expression</span>(K[n]))</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,cdf<span class="op">$</span>y,.<span class="dv">5</span>),<span class="kw">c</span>(<span class="dv">0</span>,cdf<span class="op">$</span>before,<span class="dv">1</span>),<span class="dt">type=</span><span class="st">&quot;S&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAclBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6kNtmAABmADpmAGZmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ29uQ2/+2ZgC225C2//++vr7bkDrbtmbb/9vb////tmb/25D//7b//9v////BoVybAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAVwklEQVR4nO3di5baOpaAYZIucnp6wplJ9XR30YGZooD3f8XBFgYDki15S9uS/P9rnZNKXWwKvviOvDoTCVrN/QCo7ABEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEogBEoiIDWlElzQUo7uRorgBEogBEogBEohIBOr2bLazvv6NMjrItDaD96qf54NB9IJoc5VsSQKf3G5v926d4cpRxSQAdN7+6Dw+OlRiAKoklEIlKtQ10XQSxDVR7ifbCjhuzF+ZY/gComjgORKIARKJSA9qzF1ZQE06+Ky+Bwq8CIL2mXL7BKoxuTbn8B0B0a2TFsLv0+jPeE5/wgPQmRzEaBmT1AyC6NwjI7ifVubD7OpO9sHIaAuTwk2gJdHp3Xgg0ZXKkkxvQzuUn3QVl65iTI5WcgNx+km0DHVa/Br8OoAxzARrww0Y03XMAGuADIOplBzToB0B0zwpo2A+A6J4N0IgfANG9V0BDm8/Xn/Ge+JRHpDY5itELoHE/AKJ7z4A8/ACI7j0B8uADIOr1CMjLD4Do3gMgPz8Aont9QJ5+AET37oB8Np+vP+M98SmPSG1yFKMbIH8/AKJ7HaAAPwCie1dAAXwARL0MoCA/AKJ7LaAwPwCiew2gQD8AonsXQKF+AET3DKDAn4n+jbNMjmLUAgr9mejfOMvkKEK7KYOmAIiu7QBEgnYAIkE7ANH0zNkvANG0rmdPAUST6s6+A4imdDv6DCCa0P3sBYAovN7ZLwBRcP2zpwCiwB4vXgUQhfV08TOAKKjni+cBRCG9XDwGIAro9eJDAJF/lotXAUTe2S5+BhB5Zn/vKYDIL8d7lwFEXrne+w4g8sl94xQA0XgDN04BEI02dOMUANFYQ+9dBhCNNDx0FIBouJGhxwBEg40NXQcgGmr8xikAInceN04BEDnzuXEKgMiVz9BjACJHfiM/A4jseY4cnhGg7Wq1Pr1fHpDr7vEAUsx35Pl8AO3fPi+G1ufzcfMzwuRIlP+NU3IBdHq/sDl8+zgbStLJkaiAG6fkAui4uay5Dt9/n7v/yyZHkkJunJILIJZA+RQycng2gO7bQC0l8eRoaiE3bsoJEHtheRTmJydA2pMjW4F+AEQPhd84JUNAe/bC5irYT5aAnqdyK8rkyF24nxIApZocPTfBD4CoK3Tz2ZQRoHYX/pJjCwhAaZvmJyNA+9X1+OFhxYFE/Sb6yQdQ7/gzpzL0m8gnI0DtyVQTJ1PVm+wnH0AsgWZsup98AF22ga6LILaBtBP4yQjQZSVm9sIcyx8AJWrq5rMpI0Dak6M2mR8ALT2hHwAtPCEfAC08sR8ALTq5HwAtuQh+ALTcpJvPJgCFteun8/lV7gU/iQsGtNvZX/mEn5+bx3jBzyKANJdAc/MYLfxZXC6gp1dbpUkv0Vhz/CL3lg1I+4lPAWheP8sF9LLC0SgBoJn9LB2Q8nMfHdAc/woeWyogyzavQrEBze9n8YB0n/7IgDLws1RA1t3u9MUFlAEfAOm+BFEBZeFnoYAcR/6SFxNQHn4ApPoqRASUiR8AlQkoh81n0zIBtc3wCsQClI8fAKkWCVBGfgCkWhxAGfEBkG5RAGXlB0CqxQCUlx8AqRYBUGZ+AKSaGFBOm88mAGkmBZSfHwCpJgSUoR8AqSYDlCEfAOkmApSlHwCpJgGUpx8AqSYAlKkfAKk2GVCOm88mAGk2FVC+fgCk2kRAGfsBkGrTAGXMB0C6TQKUtR8AqTYFUN5+AKTaBECZ+6kI0NaMin9oblfvVQmAct58NtUG6OC8U/1LBQDK309tgA7fPrx/IH9ABfipDFCIn/wBFcCnMkBBfrIHVISfqgD976omQGX4qQnQ6tu/3p13ibaUN6BC/NQE6LL4OW7W/j+QM6ASNp9NFQFq98Jct9i0lDGgcvyEAurdj1lpvt6Z40D7y3Lo6z83PkcT8wVUkJ9JgHo3ZU4/X+8MoNNlM+jrr7+P/zW+MZQtoIL41Afo/PXj+7//9nn6+/j+WK6AivJTEaB7X0UDKstPKkDby/7014+V+8AMgBwV5icRoNbPHx8DG90AslbS5rMpCaDj5vIN23Xz4d5smUyfb7oyBFSen3BA93tLuY/6Nsyuyg6O7wKQpQL9JDqQ2Cx99uvmI5ZA/YYBFcgnFaDj5vvvdhHkPD8OoJeK9DMBkFmLORYstw5mNbcWzzddmQEq0084oK25ZnQfcNJJNN905QWoUD/BgG7rpK8forNiAHqoxM1nUyCg0/u6+8R27fjOh/bshfVyASrXT/hu/G3N5aIxPBXBDaZjlw+ggv0ILudwHeGJPN90ZQOoYD4A0s0KqGg/qQCd3keOVgPo/jBK9pMI0G0n33mJKYBuj6JoP2nOhfXOtnIqo98LoJI3n01JTmV4LKcAZB5C6X7SAGIJ5OgJUAV+wgGZQ4lfPwbPZOy7MTLYBnroEVAFfMIBHTdmkdL96ajbVnJ+07yAdr005/sAqAo/wYC2HYneMemk803SbiZBfUB1+Ak/Fza6dRN5vknKAFAlfpZ6JHruVVgNm88m5ZOp4fNN08yA6vETvg207j6xLXgV1hOkOtcroIr8BAO6XUdW+AVlcwKqiM+E40DXIzvFX9I6hx8DqCo/E45EmxPta635pmo2QHX5qWiAqdDm2BC5AKrMD4BUM4CUZ5q25QJ6PJq4c30h6udbQAl/pRkC0Msrn+7zuwaQyu+m14IBJVzS2D+/22XxbpS4LRmQcjsAzTHfatoB6Ox7TXTM+dZSuxoDkP586+i6GQQg/flWUbcZDaCmbjXGKsy32+4ZgJq2b5/7deln4zW7790D6GyuKTu8fRZ9SatqvaNDADqbq1q//vq7/U9hvsXXP7oIoLO5rv745weA/Ho4Og2gpuZi6O1PVmE+PZ3dAFDbdt3siYl2whYC6PnsGID051tyz34ANMN882kVpbl/i9hNWoVdtn5Cbk4qmm82xfFT3u890rQDiedz2A2SBfPNJvxYm3YcqKnotzZPKOzVf9n8qbVpx4Gain5r84SCAC3Gz6TjQO3oUSNDTEWbbzaFAHL6qQ/VlI3o5mao7ruhRp5vNgUAci5+KlwssRvvmz8g9+oLQPrzzSZvQAObPwDSn282+QIa2nwG0HHz83ZdPXthloZ3vwCkP99s8gI0svsOoLPHXePjzjebfACNHf4B0PlhnE2N+WaTB6DRo4cAapKdwwidbzaNAxo/+gygc+/NqWxEP+Zx9gJA+vPNpjFAPme/AKQ/32waBuR39hRA+vPNpkFAnmffAcSBRGveV29U54clkHcDgBZz8Y8lAPnmBrRkP5MAtSsx0dsKqwK0aD+TDiS215LtZVeU1QNo2X4mnQszpzLKvltPeHZAy7n42dGEI9F/mkUP78o440eyBFra4Ao2QPiZtA3UvivjdmfvxPPNJgsg+IhOpo4fSxwYBq8GQPg5JzoO5GGsAkBT/NQHLs2BxOvQC1UvgSb5qW+RNQGQzzC/x02ziV0xoGmbzwA6N3thXrtf228fFQOauPsFoLP/NdH71c9qAU3dfQfQOeBdGV8//lIpoMm7XwBq+vrD8yzY6d19rKhkQNN33wHU1A7OseALygSHfwB0bpYr64Dpu4ahKheQ5PAhgM7CNxYWPFigecyys18AOi/8rc3Cs6cAavLeiI4y32xqAEnPvgPo7PnO1MsO2PD3FAlIfPYUQJ7tu2HIneORlwpINg0A+dXbTHJddlYoIOlEqvMT/sbC2y7YwCWtHt9VJqC5H0OGTQFkFjADgCpcAu12JR56UCgJoPv1rrVsA+0A5CgNoNuumvPKj7JejB2AXCUCFG++OdTuvgPIGoDGM4d/AGQNQKNdDx8CyBqAxuoOPwPIWjAg7zeFRZrvzN3PfgHIWppTGeqTS1Xv7GkUQPUdigTQUP2z7zEAcS5Mf75z9nD2HUDWAOTu8eoNAFkDkLOnq38AZA1Arp6vHgOQNQDZe714FUDWAGTNcvEzgKwByJbt4nkAWQOQJevF8wCyBqDX7G++AJA1AL3kePMOgKwB6DnXm78AZA1Aj7nfewogawB6aOC9y5yNtwagfkPvfed6IGsA6jX43ncAWQPQveGxEwBkDUC3RsbeAJA1AHWNjd0CIGsAMo0PHQUgawBq8xh6DEDWANTkM3QdgKwB6Ow5ci+ArAHId+RnjkRbA5DvyOGcC7MGIN+hVwFkbemA/Ed+BpC1hQMKGDkcQNaWDShk5HkAWVs0oKCR5wFkbcmAwu5cACBrCwYUeOcLAFlbLqDQO6cAyNpSAYXfuAlA1hYKKNwPgOwtE9AEPwCyt0hAE/gAyNESAU3yw9l4e1UDWkVO4zGXVs2AYvsBkCUA4UdU5YCePzVl94uGWhYg/ERvUYDgE78lAcJPghYECD8pWg4g/CRpKYAy2XzO4CFELhGg/eXFa28dv3fc11AZUC5+cngQcUsDaP/t43zcrM+5AMrED4A8M3flPb2/feYBKBM+APKtvbfzpe3bZw6AsvEDIM/MEujSdp0BoHz8AMi3js1x47o5uB6gjPwAyLu92Qe7LItmBpTL5rMpp8cSqcqPA+XlB0AzzFcyDwNIYU6+5fVoopQa0Mwb0Zm9YAASz07z8r4GkMJsAgKQ/nynt8vvKlQA6c93cjsAaZQI0OndrKgcW0DpATVbz/kB4my8Z/vV9VD0oftANLnwdpkCqq+0pzIulN4+xZMLzxz+AZBCSU+mXjrMsRt/PfoDIIVqXAJ1Rw8BpFCqbaDrImiObaDb0WcAKZRoL+y4MXthjuVPSkD3sxcAUqi240D9s6cAUqgyQA9n3wGkUF2AHq/eAJBCVQF6ungjQ0AciVafb0DPF//kB4hzYfrz9e/l4jEAKVQPoNeLDwGkUC2AbBc/A0ihSgBZL54HkEJ1ALK/+QJAClUByPHeCwApVAMg13t3AKRQBYCc7/0CkELlA3K/dxBACpUOaOi9ywBSqHBAg+99B5BCZQMaHjsBQAoVDWhk6IT8AHE2Xn++A40NvZEhoPoqGNDo0C0AUqhcQOND/wBIoVIB+Qw9BiCFCgXkNXQdgBQqE5Df0IcAUqhIQJ4jHwJIoRIB+Y6cCSCFCgTkPfIqgBQqD5D/yL0ZAuJItPp8nwoZOTw/QJwL05/vY0EjzwNIobIAhd25AEAKFQUo8MYFAFKoJEChN74AkEIFAQq+cQqAFCoHUPiNdwCkUCmAwjafr/MAUPoKATTFD4A0KgPQJD8A0qgIQJP4AEilEgBN9AMgjQoANNUPgDTKH9BkPxkC4my8+nynbT5f55EfoPrKHJDED4A0yhuQyA+ANMoakIgPgFTKGZDQD4A0yhiQ1A+ANMoXkNgPgDTKFZBs8/k6DwClL1NAMfwASKM8AUXxkyMgjkSrzDcKnxwBcS5MZb6R/ABIo0SATu/mtt/ff4dPLpYfAGmUBtB+9dN8cOg+8J9cND8A0igJoNP7jc3+7TNocnE2n6/zAFD6kgA6bn51Hx4cKzHH5GL6AZBGeS2BovoBkEaptoGui6CwbaCofACkUqK9sOPG7IU5lj/2yUX2AyCNMjoOFNsPgDTKB1B0PwDSKDWgve9e2CpJ0x50sgAknp3rpU3jB0DJy2YVtgQ/nI2fYb6UdxmeTKWSyu9kKhVVXqcyqLgyO5lKpcUSiERldTKVyiunk6lUYBwHIlEAIlEAIlEAIlEAIlGzAaJKmgmQoCSPpJiJFvNA55iHX+U8hQBSnodf5TyFAFKeh1/lPIUAUp6HX+U8hQBSnodf5TyFAFKeh1/lPIUAUp6HX+U8hQBSnodf5TyFAFKeB1UcgEgUgEgUgEgUgEgUgEgUgEgUgEgUgEgUgEgUgEgUgEgUgEhUBoAOq9W3j97ft86hGyZOtB2YzzGcyMRJvjzoCNOM9DATPaGu5gd0uPyyh94vfHCP/TFtoqf3ywf71TriJF8edIRpRnqYiZ5QZ7MDMqNWbdfd34+bCL/vw0S/fjSjGrmGRp80yecHHWOacR5moifU3eyAnp+3/dv/yH9fy4shXV48TDLSi53gYSZ6Qt3ND+iP5hm7jbl4+WuEVfbTRJu2wlf7YZKW6YunaZI+zERPqLvZAZl/cvcNgZ8xtvkeJ9p+Rrp5+jDJ1+nLp2k+I9+KTvKEussMUDN4ZwpAhyjb0MkByR9moifU3eyAXlcNCVZhEf5ha6zCIjzMRE+ouzkB7ZvjHg/bfPvr2CK/Rn4yaKK9EfYFKWxEx3iYTxON8ISONPsS6HWPOMI/mMeJ7mM8f8l34+M8zERPqLvZAb0ek4vx+/Yn+vUjxj/s5AcSIz3MRE+os/kBNYvZ5tc9va/N36P8vr2JXhfj4pf74XHu45zKSPAwEz2hrjIARCUHIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBIFIBK1cEDt0LqO0XWPm260DNswCuarp/fr2Cy3N6I//OACWjygdfPHYXhkFTeg20/2pwCg5XQF1F9+WBoAdNyYn+yPgAGg5dTJaV///XVd9vWjHdPLOGjGSvnHt4/2L+3/tmbAr06JGVb1uGlHdbp96f7t+0jDz+cagG5/7C/LmWaUp3aMuMsqyXC5+DiseoC21+/sAJkR5dplVO9Lt2/vJlptAGr+2LcLnOZlPnz/3Q162bz+hsf2Duj454dB0wEyU2iWYP0v3b69m+gcv5xKiwd0G4TSbOhcABw35vVuEJiX/tBfhbU3M7kDaoezNM56X+q+/TbRGX43nRYPaN28vpf/Na/91VKryhDZvwC6bNN8/3dvCdT7tt6XboCSj5I6dwA6X8dnftzVuq61XpZA7cKkvwprVl//106l/6XHJVDNAaj5Y9vbKjZdEVwHXW4A/Wx1tKIO/VXYhdc/72N7H7pV2M/r6rDeZY8JQM0fx81lI3jf7kl9+2iXGt1Cp/lksxd2en/7vKzafpklzGWJdadxev+P9iBQ/0vdt98mOttvmDoAtX+2g8Q3h2zMUqQdJ/fhOFBDY/XfZhvo20e3W3a+//D1W7svdd9+m2itLRwQSQMQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQiQIQifp/BUPU50V+5yIAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>The maximum value occurs at the third ``step’’, for which the Residual Value (x-axis) is</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">print</span>(cdf<span class="op">$</span>y[ind0])</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; [1] 0.0423038</span></a></code></pre></div>
<p>The CDF of the reference uniform distribution is linear on the interval <span class="math inline">\(-.5\)</span> to <span class="math inline">\(.5\)</span> (grey line). The maximum distance between the empirical CDF and reference distribution is</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">print</span>(cdf<span class="op">$</span>after[ind0] <span class="op">-</span><span class="st"> </span>(cdf<span class="op">$</span>y[ind0]<span class="op">+</span>.<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; [1] 0.2076962</span></a></code></pre></div>
<p>Check this value by calling the core R function ks.test directly,</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">ksTest &lt;-<span class="st"> </span><span class="kw">ks.test</span>(cdf<span class="op">$</span>y,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">print</span>(ksTest<span class="op">$</span>statistic)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;         D </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; 0.2076962</span></a></code></pre></div>
<p>The p-value for this test depends on the value of the statistic and the number of samples in empirical CDF (4). The p-value is <span class="math inline">\(0.982\)</span>,</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">print</span>(ksTest)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;  One-sample Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; data:  cdf$y</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; D = 0.2077, p-value = 0.982</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; alternative hypothesis: two-sided</span></a></code></pre></div>
<p>Since the p-value is greater than <span class="math inline">\(0.05\)</span>, one cannot reject the possibility that this sample was drawn from the reference distribution (though in fact it was not). This is expected due to the small number of samples, <span class="math inline">\(4\)</span>.</p>
</div>
<div id="goodness-of-fit-for-a-correct-model" class="section level2">
<h2>Goodness-of-fit for a correct model</h2>
<p>In this example, we create simulated data for which both the event and censoring hazards are constant, then fit the simulated date assuming the correct model – that is, do a maximum likelhood fit assuming constant event and censoring hazards. First, create <span class="math inline">\(1000\)</span> simulated observations with an event hazard of <span class="math inline">\(1/20\)</span> and a censoring ratio of <span class="math inline">\(0.2\)</span>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Constant transition intensities for event and censoring, with a correct</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># candidate model that also has constant transition intensities.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">387341</span>) <span class="co"># From random.org between 1 and 1,000,000</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">rho &lt;-<span class="st"> </span><span class="fl">.2</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">b1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">20</span> <span class="co"># Event rate</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">b2 &lt;-<span class="st"> </span>b1<span class="op">*</span>rho<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>rho) <span class="co"># Censoring rate</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co"># Create the simulated data</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">survObjConst &lt;-<span class="st"> </span><span class="kw">simConstHaz</span>(n,b1,b2)</a></code></pre></div>
<p>Next, do a maximum likelihood hood fit on the simulated data by calling the yada function <code>fitconstHaz</code> and calculate the event the cumulative hazards for events, censoring, and both events and censoring:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fitConst &lt;-<span class="st"> </span><span class="kw">fitConstHaz</span>(survObjConst)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">cumHazEvent &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b1 <span class="op">*</span><span class="st"> </span>survObjConst[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">cumHazCens  &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b2 <span class="op">*</span><span class="st"> </span>survObjConst[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">cumHazTot &lt;-<span class="st"> </span>cumHazEvent <span class="op">+</span><span class="st"> </span>cumHazCens</a></code></pre></div>
<p>Calculate the Martingale Survival Residual for the total hazard (i.e., accounting also for censoring) and create a histogram of the residuals:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">msrCr &lt;-<span class="st"> </span><span class="kw">calcMSR</span>(cumHazTot)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">hist</span>(msrCr,<span class="dv">40</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Probability Density&quot;</span>,<span class="dt">main=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dt">len=</span><span class="dv">1001</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">lines</span>(y,<span class="kw">calcMSRDensityConstHaz</span>(y,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>For a well-specified model, the Martingale Survival Residuals are uniformly distributed on the interval <span class="math inline">\(-0.5\)</span> to <span class="math inline">\(0.5\)</span>. This seems plausible given the preceding figure, which shows the histogram of the residuals and reference uniform distribution (solid horizontal line). The Kolmogrov-Smirnov test can be used to statically test this,</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">ksConst &lt;-<span class="st"> </span><span class="kw">ks.test</span>(msrCr,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">print</span>(ksConst<span class="op">$</span>statistic)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt;          D </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; 0.02302752</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw">print</span>(ksConst<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; [1] 0.6639313</span></a></code></pre></div>
<p>Since the p-value for the test is greater than <span class="math inline">\(0.05\)</span>, one cannot reject that the calculated residuals are drawn from the uniform distribution. Hence, the fit passes the goodness-of-fit test. In the next seection, we describe a fit that fails this goodness-of-fit of test.</p>
</div>
<div id="goodness-of-fit-for-an-incorrect-model" class="section level2">
<h2>Goodness-of-fit for an incorrect model</h2>
<p>In this example, we create simulated data for which the event hazard is linear and the censoring hazard is constant, then fit the simulated date assuming in incorrect model in which both hazards are assumed to be constant. First, create <span class="math inline">\(1000\)</span> simulated observations with an event hazard of <span class="math inline">\(1/20\)</span> and a censoring ratio of <span class="math inline">\(0.2\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Time dependent (linear) event intensity and constant censoring, with an incorrect</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># candidate model that has constant transition intensities.</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">51600</span>) <span class="co"># From random.org between 1 and 1,000,000</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">rho &lt;-<span class="st"> </span><span class="fl">.2</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">b1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">20</span> <span class="co"># Event rate</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">b2 &lt;-<span class="st"> </span>b1<span class="op">*</span>rho<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>rho) <span class="co"># Censoring rate [rho is only apporoximately the censoring ratio given a linear event hazard]</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">a1 &lt;-<span class="st"> </span>b1<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">survObjLin &lt;-<span class="st"> </span><span class="kw">simLinHaz</span>(n,b1,a1,b2)</a></code></pre></div>
<p>Next, do a maximum likelihood hood fit on the simualted data by calling the yada function <code>fitconstHaz</code> and calculate the event the cumulative hazards for events, censoring, and both events and censoring:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">fitConst &lt;-<span class="st"> </span><span class="kw">fitConstHaz</span>(survObjLin) <span class="co"># The wrong model</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">cumHazEvent &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b1 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">cumHazCens  &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b2 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">cumHazTot &lt;-<span class="st"> </span>cumHazEvent <span class="op">+</span><span class="st"> </span>cumHazCens</a></code></pre></div>
<p>Calculate the Martingale Survival Residual for the total hazard (i.e., accounting also for censoring) and create a histogram of the residuals:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">msrCr &lt;-<span class="st"> </span><span class="kw">calcMSR</span>(cumHazTot)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">hist</span>(msrCr,<span class="dv">40</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Probability Density&quot;</span>,<span class="dt">main=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dt">len=</span><span class="dv">1001</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">lines</span>(y,<span class="kw">calcMSRDensityConstHaz</span>(y,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>For a well-specified model, the Martingale Survival Residuals are uniformly distributed on the interval <span class="math inline">\(-0.5\)</span> to <span class="math inline">\(0.5\)</span>. This does not seem plausible given the preceding figure, which shows the histogram of the residuals and reference uniform distribution (solid horizontal line). The Kolmogrov-Smirnov test can be used to statically test this,</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">ksLin &lt;-<span class="st"> </span><span class="kw">ks.test</span>(msrCr,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">print</span>(ksLin<span class="op">$</span>statistic)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt;         D </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; 0.1039834</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="kw">print</span>(ksLin<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt; [1] 8.116515e-10</span></a></code></pre></div>
<p>Since the p-value for the test is less than <span class="math inline">\(0.05\)</span>, one rejects that the calculated residuals are drawn from the uniform distribution. Hence, the fit fails the goodness-of-fit test.</p>
</div>
<div id="power-calculation" class="section level2">
<h2>Power calculation</h2>
<p>In this example, we extend the preceding example that assesses an incorrect model to determine the number of samples needed to reject an incorrect model. That is, how many observations are needed to determine that the (incorrect) constant intensity model is wrong? The effect size is <span class="math inline">\(a_1\)</span>, which differs from zero (the null). The significance criterion is <span class="math inline">\(\alpha=.05\)</span> (Type 1 errors, mistakenly rejecting the null when it is true). The power is <span class="math inline">\(1 - \beta(n)\)</span>, where <span class="math inline">\(\beta\)</span> is the rate of Type 2 errors (mistakenly accepting the null when it is false). <span class="math inline">\(\beta\)</span> is calculated repeatedly via simulation as a function of the number of observations, <span class="math inline">\(n\)</span>. Often, n is chosen to achieve a power of <span class="math inline">\(.8\)</span> (<span class="math inline">\(\beta=.2\)</span>).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">nVect &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">500</span>,<span class="dt">by=</span><span class="dv">10</span>) <span class="co"># The vector of number of observations</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">powerVect &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">length</span>(nVect)) <span class="co"># The vector in which to store the power (1-beta)</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">Nmc &lt;-<span class="st"> </span><span class="dv">50000</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="kw">options</span>(<span class="dt">warn=</span><span class="op">-</span><span class="dv">1</span>) <span class="co"># The numerical simulation yields very occasional ties. Suppress warnings this creates in ks.test</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nVect)) {</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">    numSig &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10">    n &lt;-<span class="st"> </span>nVect[ii]</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">    <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Nmc) {</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">        survObjLin &lt;-<span class="st"> </span><span class="kw">simLinHaz</span>(n,b1,a1,b2)</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">        fitConst &lt;-<span class="st"> </span><span class="kw">fitConstHaz</span>(survObjLin) <span class="co"># The wrong model</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14">        cumHazEvent &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b1 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">        cumHazCens  &lt;-<span class="st"> </span>fitConst<span class="op">$</span>b2 <span class="op">*</span><span class="st"> </span>survObjLin[,<span class="st">'time'</span>]</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">        cumHazTot &lt;-<span class="st"> </span>cumHazEvent <span class="op">+</span><span class="st"> </span>cumHazCens</a>
<a class="sourceLine" id="cb20-17" data-line-number="17">        <span class="co"># Martingale Survival Residual treating censoring as a competing risk</span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18">        msrCr &lt;-<span class="st"> </span><span class="kw">calcMSR</span>(cumHazTot)</a>
<a class="sourceLine" id="cb20-19" data-line-number="19">        ks2Pc &lt;-<span class="st"> </span><span class="kw">ks.test</span>(msrCr,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20">        <span class="cf">if</span>(ks2Pc<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha) {</a>
<a class="sourceLine" id="cb20-21" data-line-number="21">            numSig &lt;-<span class="st"> </span>numSig <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22">        }</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">        powerVect[ii] &lt;-<span class="st"> </span>numSig <span class="op">/</span><span class="st"> </span>Nmc</a>
<a class="sourceLine" id="cb20-24" data-line-number="24">    }</a>
<a class="sourceLine" id="cb20-25" data-line-number="25">}</a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="kw">options</span>(<span class="dt">warn=</span><span class="dv">0</span>) <span class="co"># Turn warnings back on</span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"></a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="co"># Make the power zero at the origin for plotting</span></a>
<a class="sourceLine" id="cb20-29" data-line-number="29">nVect &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,nVect)</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">powerVect &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,powerVect)</a>
<a class="sourceLine" id="cb20-31" data-line-number="31"></a>
<a class="sourceLine" id="cb20-32" data-line-number="32"><span class="co"># Interpolate the curve's value for beta=.2 and beta = .1</span></a>
<a class="sourceLine" id="cb20-33" data-line-number="33">y1 &lt;-<span class="st"> </span><span class="fl">.8</span></a>
<a class="sourceLine" id="cb20-34" data-line-number="34">y2 &lt;-<span class="st"> </span><span class="fl">.9</span></a>
<a class="sourceLine" id="cb20-35" data-line-number="35"></a>
<a class="sourceLine" id="cb20-36" data-line-number="36">x1 &lt;-<span class="st"> </span><span class="kw">approx</span>(powerVect,nVect,y1)<span class="op">$</span>y</a>
<a class="sourceLine" id="cb20-37" data-line-number="37">x2 &lt;-<span class="st"> </span><span class="kw">approx</span>(powerVect,nVect,y2)<span class="op">$</span>y</a></code></pre></div>
<p>Plot the results of the power calculation:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,x1),<span class="kw">c</span>(y1,y1),<span class="dt">xlab=</span><span class="st">&quot;Sample Size&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Power&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">500</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">lines</span>(<span class="kw">c</span>(x1,x1),<span class="kw">c</span>(<span class="dv">0</span>,y1),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">0</span>,x2),<span class="kw">c</span>(y2,y2),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw">lines</span>(<span class="kw">c</span>(x2,x2),<span class="kw">c</span>(<span class="dv">0</span>,y2),<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>,<span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw">lines</span>(nVect,powerVect,<span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="another-mis-specified-model-proportional-hazards-fit-to-an-additive-data" class="section level2">
<h2>Another mis-specified model: Proportional hazards fit to an additive data</h2>
<p>A very common assumption in survival analysis is the proportional hazards assumption: the effect of some covariate on the baseline or reference hazard is multiplicative. MSRs can be used to assess this assumption, as we demonstrate in this simulation. To begin, load necessary libraries, set the random number seed, then generate simulated data</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">library</span>(survival)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">## Additive covariates incorrectly fit as proportional covariates</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">2105984</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5"></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co"># Define the starting age (15 years)</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7">x0 &lt;-<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co"># From Gage and Dyke 1986, Table 2, Level 15</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">afem &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">175</span>,<span class="fl">1.40</span>,.<span class="dv">368</span><span class="op">*</span>.<span class="dv">01</span>,.<span class="dv">075</span><span class="op">*</span>.<span class="dv">001</span>,.<span class="dv">917</span><span class="op">*</span>.<span class="dv">1</span>) <span class="co"># Female parameterization</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="co"># Males are assumed to have a higher hazard by an additive (constant) amount</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">maleBoost &lt;-<span class="st"> </span>afem[<span class="dv">3</span>]<span class="op">*</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14">amal &lt;-<span class="st"> </span>afem <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,maleBoost,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"></a>
<a class="sourceLine" id="cb22-16" data-line-number="16">N &lt;-<span class="st"> </span><span class="dv">2000</span> <span class="co"># Number of simulated observations</span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="co"># Sample randomly for male/female</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18">female &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>),N,<span class="dt">replace=</span>T)</a>
<a class="sourceLine" id="cb22-19" data-line-number="19"></a>
<a class="sourceLine" id="cb22-20" data-line-number="20"><span class="co"># Sample from the relevant Siler hazard</span></a>
<a class="sourceLine" id="cb22-21" data-line-number="21">x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,N) <span class="co"># vector of simulated ages</span></a>
<a class="sourceLine" id="cb22-22" data-line-number="22">x[ female] &lt;-<span class="st"> </span><span class="kw">rsiler</span>(<span class="kw">sum</span>( female),afem,x0)</a>
<a class="sourceLine" id="cb22-23" data-line-number="23">x[<span class="op">!</span>female] &lt;-<span class="st"> </span><span class="kw">rsiler</span>(<span class="kw">sum</span>(<span class="op">!</span>female),amal,x0)</a></code></pre></div>
<p>In the preceding block of code, the mortality hazard for females is simulated with a Siler hazard, with the parameters drawn from Table 2 / Level 15 of Gage and Dyke (1986). Males are assumed to have an additive boost in hazard relative females. In particular, the constant term (third parameter) is simulated as being twice as high for males as for females. We assume contingent survival to <span class="math inline">\(x_0 = 15\)</span> for the simulation. The probabilities of being female and male are assumed equal, <span class="math inline">\(0.5\)</span>, and simulated ages are sampled using the yada function <code>rsiler</code>.</p>
<p>Next, define objective functions to do a maximum likelihood fit for two models: the correct additive model and an incorrect multiplicative model in which the male hazard is assumed to be equal to the female hazard times a constant.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Objective function for additive fit</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">fadd &lt;-<span class="st"> </span><span class="cf">function</span>(param,x,female,x0,a0) {</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">    <span class="co"># Calculate the objective function (negative log-likelihood)</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">    <span class="co"># given the input parameters (param), age-at-death vector (x),</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    <span class="co"># and boolean vector indicating sex (female)</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">    a &lt;-<span class="st"> </span>a0 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(param)</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">    afem &lt;-<span class="st"> </span>a[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">    amal &lt;-<span class="st"> </span>afem <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,a[<span class="dv">6</span>],<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">    xFemale &lt;-<span class="st"> </span>x[female]</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">    xMale &lt;-<span class="st"> </span>x[<span class="op">!</span>female]</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">    nll &lt;-<span class="st"> </span><span class="kw">nllsiler</span>(afem,xFemale,x0) <span class="op">+</span><span class="st"> </span><span class="kw">nllsiler</span>(amal,xMale,x0)</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">    <span class="kw">return</span>(nll)</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb23-16" data-line-number="16"></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co"># Objective function for multiplicative fit</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18">fmult &lt;-<span class="st"> </span><span class="cf">function</span>(param,x,female,x0,a0) {</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">    <span class="co"># Calculate the objective function (negative log-likelihood)</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20">    <span class="co"># given the input parameters (param), age-at-death vector (x),</span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21">    <span class="co"># and boolean vector indicating sex (female)</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22">    a &lt;-<span class="st"> </span>a0 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(param)</a>
<a class="sourceLine" id="cb23-23" data-line-number="23">    afem &lt;-<span class="st"> </span>a[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb23-24" data-line-number="24">    amal &lt;-<span class="st"> </span>afem <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(a[<span class="dv">6</span>],<span class="dv">1</span>,a[<span class="dv">6</span>],<span class="dv">1</span>,a[<span class="dv">6</span>])</a>
<a class="sourceLine" id="cb23-25" data-line-number="25"></a>
<a class="sourceLine" id="cb23-26" data-line-number="26">    xFemale &lt;-<span class="st"> </span>x[female]</a>
<a class="sourceLine" id="cb23-27" data-line-number="27">    xMale &lt;-<span class="st"> </span>x[<span class="op">!</span>female]</a>
<a class="sourceLine" id="cb23-28" data-line-number="28"></a>
<a class="sourceLine" id="cb23-29" data-line-number="29">    nll &lt;-<span class="st"> </span><span class="kw">nllsiler</span>(afem,xFemale,x0) <span class="op">+</span><span class="st"> </span><span class="kw">nllsiler</span>(amal,xMale,x0)</a>
<a class="sourceLine" id="cb23-30" data-line-number="30">    <span class="kw">return</span>(nll)</a>
<a class="sourceLine" id="cb23-31" data-line-number="31">}</a></code></pre></div>
<p>Use these objective functions to fit the additive (correct) and multiplicative (incorrect) models and extract the fit parameters.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Fit the additive and multiplicative models and extract the fit parameters</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">a0_add &lt;-<span class="st"> </span><span class="kw">c</span>(afem,maleBoost)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">paramFitAdd &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),fadd,<span class="dt">x=</span>x,<span class="dt">female=</span>female,<span class="dt">x0=</span>x0,<span class="dt">a0=</span>a0_add)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">afem_add &lt;-<span class="st"> </span>a0_add[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(paramFitAdd<span class="op">$</span>par[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">amal_add &lt;-<span class="st"> </span>afem_add <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,a0_add[<span class="dv">6</span>]<span class="op">*</span><span class="kw">exp</span>(paramFitAdd<span class="op">$</span>par[<span class="dv">6</span>]),<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6"></a>
<a class="sourceLine" id="cb24-7" data-line-number="7">a0_mult &lt;-<span class="st"> </span><span class="kw">c</span>(afem,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">paramFitMult &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),fmult,<span class="dt">x=</span>x,<span class="dt">female=</span>female,<span class="dt">x0=</span>x0,<span class="dt">a0=</span>a0_mult)</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">afem_mult &lt;-<span class="st"> </span>a0_mult[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(paramFitMult<span class="op">$</span>par[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">amal_mult &lt;-<span class="st"> </span>afem_mult <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(a0_mult[<span class="dv">6</span>]<span class="op">*</span><span class="kw">exp</span>(paramFitMult<span class="op">$</span>par[<span class="dv">6</span>]),<span class="dv">1</span>,a0_mult[<span class="dv">6</span>]<span class="op">*</span><span class="kw">exp</span>(paramFitMult<span class="op">$</span>par[<span class="dv">6</span>]),<span class="dv">1</span>,a0_mult[<span class="dv">6</span>]<span class="op">*</span><span class="kw">exp</span>(paramFitMult<span class="op">$</span>par[<span class="dv">6</span>]))</a></code></pre></div>
<p>Apply these fits to calculate survivals, MSRs, and do the Kolmogorov-Smirnov test.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Calculate the survivals, Martingale Survival Residuals (MSRs), and do the Kolmogorov-Smirnov tests</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">S_add &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,N)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">S_add[ female] &lt;-<span class="st"> </span><span class="kw">ssiler</span>(x[ female],afem_add,x0)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">S_add[<span class="op">!</span>female] &lt;-<span class="st"> </span><span class="kw">ssiler</span>(x[<span class="op">!</span>female],amal_add,x0)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"></a>
<a class="sourceLine" id="cb25-6" data-line-number="6">S_mult &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,N)</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">S_mult[ female] &lt;-<span class="st"> </span><span class="kw">ssiler</span>(x[ female],afem_mult,x0)</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">S_mult[<span class="op">!</span>female] &lt;-<span class="st"> </span><span class="kw">ssiler</span>(x[<span class="op">!</span>female],amal_mult,x0)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">Dhat_add &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>S_add)</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">ks_add &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_add,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12">ks_add_fem &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_add[ female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13">ks_add_mal &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_add[<span class="op">!</span>female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"></a>
<a class="sourceLine" id="cb25-15" data-line-number="15">Dhat_mult &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>S_mult)</a>
<a class="sourceLine" id="cb25-16" data-line-number="16">ks_mult &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_mult,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17">ks_mult_fem &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_mult[ female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18">ks_mult_mal &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_mult[<span class="op">!</span>female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a></code></pre></div>
<p>The Cox model also makes a proportional hazards assumption, but it is a semi-parametric model due to its use of a non-parametric baseline hazard. Repeat the preceding steps for a Cox model so that it can be compared against the additive and (parametric) multiplicative models.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Fit a Cox model, calculate the survivals / MSRs, and to the Kolmogorov-Smirnov tests </span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">sampDf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x,<span class="dt">female=</span>female)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">coxFit &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(x)<span class="op">~</span>female,<span class="dt">data=</span>sampDf)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">cumHazCox &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(coxFit,sampDf,<span class="dt">type=</span><span class="st">&quot;expected&quot;</span>))</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">survCox &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>cumHazCox)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">Dhat_cox &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>survCox)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">ks_cox &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_cox,punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">ks_cox_fem &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_cox[ female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">ks_cox_mal &lt;-<span class="st"> </span><span class="kw">ks.test</span>(Dhat_cox[<span class="op">!</span>female],punif,<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># The Kolmogorov-Smirnov test</span></a></code></pre></div>
<p>To aid interpretation, print out the p-values from the KS tests for the additive, multiplicative, and Cox models.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># Create and print out a summary data frame</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">testName &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Add All&quot;</span>,<span class="st">&quot;Mlt All&quot;</span>,<span class="st">&quot;Cox All&quot;</span>,<span class="st">&quot;Add Fem&quot;</span>,<span class="st">&quot;Add Mal&quot;</span>,<span class="st">&quot;Mlt Fem&quot;</span>,<span class="st">&quot;Mlt Mal&quot;</span>,<span class="st">&quot;Cox Fem&quot;</span>,<span class="st">&quot;Cox Mal&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">pvalVect &lt;-<span class="st"> </span><span class="kw">c</span>(ks_add<span class="op">$</span>p.value,ks_mult<span class="op">$</span>p.value,ks_cox<span class="op">$</span>p.value,ks_add_fem<span class="op">$</span>p.value,ks_add_mal<span class="op">$</span>p.value,ks_mult_fem<span class="op">$</span>p.value,ks_mult_mal<span class="op">$</span>p.value,ks_cox_fem<span class="op">$</span>p.value,ks_cox_mal<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">dfOut &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">test=</span>testName,<span class="dt">pval=</span>pvalVect)</a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="kw">print</span>(dfOut)</a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">#&gt;      test         pval</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="co">#&gt; 1 Add All 6.678553e-01</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="co">#&gt; 2 Mlt All 5.536954e-01</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">#&gt; 3 Cox All 7.036147e-01</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">#&gt; 4 Add Fem 6.821200e-01</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">#&gt; 5 Add Mal 9.495975e-01</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">#&gt; 6 Mlt Fem 1.496860e-08</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">#&gt; 7 Mlt Mal 2.175484e-08</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">#&gt; 8 Cox Fem 6.737196e-04</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">#&gt; 9 Cox Mal 1.301728e-03</span></a></code></pre></div>
<p>When the KS-test is applied to the pooled residuals for female and male, none of the models can be rejected since the pertinent p-values are greater than <span class="math inline">\(0.05\)</span>. However, the mis-specified models (multiplicative and Cox) are not good fits, which is apparent when the KS-test is applied separately for females and males. Both models are biased, which is reflected in non-uniformily distributed residuals. In contrast, the correct additive model is not rejected after stratifying by female/male. To gain additional insight, plot the histograms of stratified residuals.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Plot the MSR histograms stratified by female/male</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">femCol &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">malCol &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="kw">hist</span>(Dhat_add[ female],<span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Probability Density&quot;</span>,<span class="dt">main=</span><span class="ot">NULL</span>,<span class="dt">col=</span>femCol)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="kw">hist</span>(Dhat_add[<span class="op">!</span>female],<span class="dv">100</span>,<span class="dt">add=</span>T,<span class="dt">freq=</span>F,<span class="dt">col=</span>malCol)</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dt">len=</span><span class="dv">1001</span>)</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="kw">lines</span>(y,<span class="kw">calcMSRDensityConstHaz</span>(y,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="kw">box</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> In the preceding histogram, residuals for females are plotted in red and those for males in green. Transparency is used to simultaneously visualize both sets of residuals together. For the additive model, there is no clear bias in the two distributions. However, for the multiplicative and Cox models (plotted next) there are clear biases in the residual disrtributions: each mis-specified fit yields an overall distribution of residuals that is close to uniform, but there are definite regions where a bias exists towards males or females in the histograms. Hence, we reject these two mis-specified fits.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">hist</span>(Dhat_mult[ female],<span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Probability Density&quot;</span>,<span class="dt">main=</span><span class="ot">NULL</span>,<span class="dt">col=</span>femCol)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">hist</span>(Dhat_mult[<span class="op">!</span>female],<span class="dv">100</span>,<span class="dt">add=</span>T,<span class="dt">freq=</span>F,<span class="dt">col=</span>malCol)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw">lines</span>(y,<span class="kw">calcMSRDensityConstHaz</span>(y,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="kw">box</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">hist</span>(Dhat_cox[ female],<span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Residual Value&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Probability Density&quot;</span>,<span class="dt">main=</span><span class="ot">NULL</span>,<span class="dt">col=</span>femCol)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">hist</span>(Dhat_cox[<span class="op">!</span>female],<span class="dv">100</span>,<span class="dt">add=</span>T,<span class="dt">freq=</span>F,<span class="dt">col=</span>malCol)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">lines</span>(y,<span class="kw">calcMSRDensityConstHaz</span>(y,<span class="dv">0</span>),<span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="kw">box</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
